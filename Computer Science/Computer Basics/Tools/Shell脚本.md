**1. Linux与Shell**

我们常用的电脑由硬件和软件组成，操作系统作为最核心的软件负责与硬件进行交互，一般的操作系统由内核kernel和shell组成，shell是一个人类与计算机交互的软件，在很多系统中都有。我们可以将希望的操作输入shell中，shell负责传递给kernel，kernel与硬件进行交互。shell有很多种，最常用的是Bourne Again Shell，简称bash，也是Linux系统和Mac系统中最常用的shell。还有很多其他种类的shell，比如大数据平台hadoop也是利用shell进行人与系统的交互的，这些shell的语法与bash类似。可能熟悉Windows系统的同学会问，为什么需要Linux和Shell脚本？用图形界面和鼠标点一点不就能进行各种操作了吗？在大多数情况下，我们需要在远程的机器上进行开发，而这些开发机的操作系统都是Linux，如果你希望找一份软件工程师的工作，那么Linux和Shell的知识必知必会。

**2. Linux基础知识**

2.1 文件系统与路径

要学会使用Linux，首先要明白文件系统和路径的概念。Linux的文件系统是树形结构，系统下面的根目录是 / ，它通常包含了多个子目录，. 代表当前目录，.. 代表上级目录，使用cd命令可以改变当前工作目录，pwd命令可以显示当前所处目录，ls命令可以现在当前所在目录下有哪些字目录和文件，这三个命令是最常用的命令。下面给出Linux系统文件目录。

![img](https://pic1.zhimg.com/v2-5ddfd8ebc1504941eb7d194d3271bea0_b.png)

- /bin，它是重要的二进制应用程序，包含二进制文件，系统的所有用户使用的命令都在这里
- /boot，启动包含引导加载程序的相关文件
- /dev，包含设备文件，终端文件，USB 或者连接到系统的任何设备
- /etc，配置文件，启动脚本等，包含所有程序所需要的配置文件，也包含了启动/停止单个应用程序的启动和关闭 shell 脚本
- /home，本地主要路径，所有用户用 home 目录存储个人信息
- /lib，系统库文件，包含支持位于 /bin 和 /sbin 下的二进制库文件
- /lost+found，在根目录下提供一个遗失+查找系统，必须在 root 用户下才能查看当前目录下的内容
- /media，挂载可移动介质
- /mnt，挂载文件系统
- /opt，提供一个可选的应用程序安装目录
- /proc，特殊的动态目录，用于维护系统信息和状态，包括当前运行中进程信息
- /root，root 用户的主要目录文件夹
- /sbin，重要的二进制系统文件
- /tmp， 系统和用户创建的临时文件，系统重启时，这个目录下的文件都会被删除
- /usr，包含绝大多数用户都能访问的应用程序和文件
- /var，经常变化的文件，诸如日志文件或数据库等

常用目录有如下几个

**/etc**： 系统中的配置文件，如果更改了该目录下的某个文件可能会导致系统不能启动。

**/bin, /sbin, /usr/bin, /usr/sbin**: 这是系统预设的执行文件的放置目录，比如 ls 就是在 /bin/ls 目录下的。值得提出的是，/bin, /usr/bin 是给系统用户使用的指令（除root外的通用户），而/sbin, /usr/sbin 则是给 root 使用的指令。 

**/var**： 这是一个非常重要的目录，系统上跑了很多程序，那么每个程序都会有相应的日志产生，而这些日志就被记录到这个目录下，具体在 /var/log 目录下，另外 mail 的预设放置也是在这里。

2.2 环境变量

Linux系统中存在一个环境变量PATH，使用echo $PATH命令可以查看这个变量。你可能会疑惑我们常用的ls pwd命令为什么能直接调用而不用使用路径。其实他们的路径已经存在PATH变量里面，每次使用这些命令的时候系统会在PATH变量的目录里自动搜索这些命令。如下所示，常用的目录都已经设置在环境变量中了，这里: 起到了分隔符的作用，通常我们新下载了某个包之后，如果想直接调用它，就需要将这个包放置在环境变量对应的目录下，或者在环境变量中增加包所对应的目录。

```
missing:~$ echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
```

2.3 读写权限与超级用户

Linux 系统是一种典型的多用户系统，不同的用户处于不同的地位，拥有不同的权限。为了保护系统的安全性，Linux 系统对不同的用户访问同一文件（包括目录文件）的权限做了不同的规定。 在Linux系统中，用户是按组分类的，一个用户属于一个或多个组。文件所有者以外的用户又可以分为文件所有者的同组用户和其他用户。因此，Linux系统按文件所有者、文件所有者同组用户和其他用户来规定了不同的文件访问权限。

使用ls -l命令可以查看一个文件或者目录的属性。如下所示，d代表/home是一个目录，d后面跟着9个字符，每3个一组，前3个代表这个目录或者文件所有者的权限，中间3个代表用户组的权限，后面3个代表所有人的权限。对于文件来说，rwx三个参数，r代表读权限，w代表写权限，x代表执行权限，-代表没有对应的权限。目录与文件不同的是x代表进入这个目录的权限，r代表可以列出目录下内容的权限，w代表可以修改目录下内容的权限。

![img](https://pic2.zhimg.com/v2-deb1a6274f8d3d2b9946a95731ef0ff5_b.png)

Linux系统中存在一个超级用户root，这个用户不受任何权限限制，可以增加、删除、修改文件和目录，为了使用超级权限，可以在想用的命令前加上sudo，也就是do as super作为超级用户执行命令

```
missing:~$ ls -l /home
drwxr-xr-x 1 missing  users  4096 Jun 15  2019 missing
```

2.4 Linux常用命令

目录操作命令：

- ls（英文全拼：list files）: 列出目录及文件名
- cd（英文全拼：change directory）：切换目录
- pwd（英文全拼：print work directory）：显示目前的目录
- mkdir（英文全拼：make directory）：创建一个新的目录
- rmdir（英文全拼：remove directory）：删除一个空的目录
- cp（英文全拼：copy file）: 复制文件或目录，-r递归拷贝
- rm（英文全拼：remove）: 删除文件或目录，-f强制删除，-r递归删除
- mv（英文全拼：move file）: 移动文件与目录，或修改文件与目录的名称，-f强制移动

文件操作命令：

- cat   由第一行开始显示文件内容
- tac   从最后一行开始显示，可以看出 tac 是 cat 的倒着写！
- nl   显示的时候，顺道输出行号！
- more 一页一页的显示文件内容
- less 与 more 类似，但是比 more 更好的是，他可以往前翻页！
- head 只看头几行
- tail 只看尾巴几行

**3. Linux命令高级特性**

3.1 输入/输出重定向

一般情况下，每个 Unix/Linux 命令运行时都会打开三个文件：

- 标准输入文件(stdin)：stdin的文件描述符为0，Unix程序默认从stdin读取数据。
- 标准输出文件(stdout)：stdout 的文件描述符为1，Unix程序默认向stdout输出数据。
- 标准错误文件(stderr)：stderr的文件描述符为2，Unix程序会向stderr流中写入错误信息。

常用的重定向操作符如下：

- command > file：将输出重定向到 file
- command < file：将输入重定向到 file
- command >> file：将输出以追加的方式重定向到 file
- n > file：将文件描述符为 n 的文件重定向到 file。
- n >> file：将文件描述符为 n 的文件以追加的方式重定向到 file
- n >& m：将输出文件 m 和 n 合并
- n <& m：将输入文件 m 和 n 合并
- << tag：将开始标记 tag 和结束标记 tag 之间的内容作为输入

3.2 管道操作符

Linux中，｜代表管道操作符，管道操作符允许我们将一个程序的输出和另外一个程序的输入连接起来，如下所示

```
missing:~$ ls -l / | tail -n1
drwxr-xr-x 1 root  root  4096 Jun 20  2019 var
```

3.3 通配符

Linux命令中可以加入通配符，?代表任意一个字符，*代表任意多个字符，{}可以扩展命令，如下所示第一个命令可以扩展成第二个命令。

```
convert image.{png,jpg}
# Will expand to
convert image.png image.jpg
```

**4.Shell脚本**

4.1 Shell变量

定义变量时，变量名不加美元符号，变量名和等号之间不能有空格，否则会被认为变量名是一个程序，空格后的是参数。而使用一个定义过的变量，只要在变量名前面加美元符号即可。 

对于字符串变量来说，单引号与双引号不同。单引号里的任何字符都会原样输出，单引号字符串中的变量是无效的，单引号字串中不能出现单独一个的单引号（对单引号使用转义符后也不行），但可成对出现，作为字符串拼接使用。而双引号里可以有变量，也可以出现转义字符。

4.2 Shell传参

和其他大多数的编程语言一样，Shell也支持if, case, while 和 for 这些控制流关键字。同样地，Shell也支持函数，可以接受参数并基于参数进行操作。Shell使用了很多特殊的变量来表示参数、错误代码和相关变量，如下所示：

- $0 - 脚本名
- $1 到 $9 - 脚本的参数。 $1 是第一个参数，依此类推。
- $@ - 所有参数
- $# - 参数个数
- $? - 前一个命令的返回值
- $$ - 当前脚本的进程识别码
- !! - 完整的上一条命令，包括参数。常见应用：当你因为权限不足执行命令失败时，可以使用 sudo !!再尝试一次。
- $_ - 上一条命令的最后一个参数。如果你正在使用的是交互式shell，你可以通过按下 Esc 之后键入 . 来获取这个值。

4.3 Shebang行

在Shell脚本的第一行，一般是Shebang行，这一行定义了环境变量，如下所示将会使用python执行这个shell脚本。

```
#!/usr/local/bin/python
import sys
for arg in reversed(sys.argv[1:]):
    print(arg)
```